import os
import urllib.request
import zipfile

# delete all files in malware_db folder
malware_db_path = "..\\data\\malware_hashes\\"

def delfile():
	for malware_db_file in os.listdir(malware_db_path):
		removablefile = malware_db_path + malware_db_file
		try:
			# remove old malware db file
			print(f"Removing file: {removablefile}")
			os.remove(removablefile)
		except Exception as e:
			print(e)
			exit()

newpath = malware_db_path + "hashes.zip"
def downloadfile():
	# download new malware db file
	print("Downloading new file: ")
	urllib.request.urlretrieve("https://prohack.tech/Products/Security-Lite/hashes.zip", newpath)

def unpack():
	print("Unpacking file..")
	compressed_file = zipfile.ZipFile(newpath, 'r')
	compressed_file.extractall(malware_db_path)
	compressed_file.close()
	print("Deleting ardchive..")
	os.remove(newpath)

delfile()
downloadfile()
unpack()
print("Done! Exiting")
exit()
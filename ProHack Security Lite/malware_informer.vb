Imports System.IO

Public Class malware_informer

    Sub New()
        InitializeComponent()
        Me.DoubleBuffered = True
    End Sub

    Public Sub refresher()
        Threading.Thread.Sleep(2000)
        utils.removeCards()
        perform_check()
    End Sub

    Public Sub perform_check()
        flowDetections.Controls.Clear()
        utils._check_detections_()
        Dim numDetections As Integer = flowDetections.Controls.Count
        lblTotalDetected.Text = "Total Detections: " & numDetections.ToString
    End Sub

    Private Sub btnExit_MouseEnter(sender As Object, e As EventArgs) Handles btnExit.MouseEnter
        Try
            btnExit.BackgroundImage = Image.FromFile(Application.StartupPath & "/res/common_controls/shutdown_hover.png")
        Catch ex As Exception
            utils.invoke_msg(2, "Icon Error", ex.Message.ToString)
        End Try
    End Sub

    Private Sub btnExit_MouseLeave(sender As Object, e As EventArgs) Handles btnExit.MouseLeave
        Try
            btnExit.BackgroundImage = Image.FromFile(Application.StartupPath & "/res/common_controls/shutdown.png")
        Catch ex As Exception
            utils.invoke_msg(2, "Icon Error", ex.Message.ToString)
        End Try
    End Sub

    Private Sub malware_informer_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        perform_check()
    End Sub

    Private Sub btnExit_Click(sender As Object, e As EventArgs) Handles btnExit.Click
        flowDetections.Dispose()
        GC.Collect()
        Me.Close()
    End Sub
End Class